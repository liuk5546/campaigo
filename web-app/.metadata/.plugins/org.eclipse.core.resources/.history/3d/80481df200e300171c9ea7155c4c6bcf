package com.campaigo.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import com.campaigo.model.PartyRelationShip;
import com.campaigo.util.DBUtil;


public class PartyRelationShipDAO {
	public PartyRelationShip findbyKey(int campaiId, String userid){
		//这里只有一个返回值，说明一个人仅能参加一次一个活动。
		PartyRelationShip ret = new PartyRelationShip();
		try {
			Connection conn = DBUtil.getConnection();
			String sql ="select role from party_relationship where party_relationship_id=? and party_relationship_camid=?";
			PreparedStatement pst = conn.prepareStatement(sql);
			ResultSet rs;
			pst.setString(1, userid);
			pst.setInt(2, campaiId);
			rs = pst.executeQuery();
			if(rs.next()){
				ret.setRole(rs.getInt(1));
				ret.setPartyRelationShipId(userid);
				ret.setPartyRelationShipIdCamId(campaiId);
			}
			conn.close();
			rs.close();
			pst.close();
		} catch (SQLException e) {
			// TODO: handle exception
		}
		return ret;
	}
}
